## Encrypted Messages in Bulletin Board
Advances in privacy and scaling solutions make wider adoption of blockchain technology much more realizable. With strong security guarantees backed by well founded maths, you will be able to exchange secure messages through a blockchain. You will, as always, have to be careful with handling private keys, much like you have been with passwords; there will also be better solutions to make key-management easier and more fool-proof. 

Yet this promise of being able to make secure message is not always convenient to accept when you consider the following.
1. The message exchanged could be opinionated, deeply personal or of high importance
2. Once you've written it in blockchain, it can not be reverted back
3. Now this message is publicly vieweable. Despite being in obfuscated (encrypted) form, a bad actor can try as much as he wants to break the encryption. It can even be the case that the secret has already been found out and the bad actor is passively collecting information -- no way to know.
4. Codes have bugs and vulnerabilities. Incentive to not share the knowledge of vulnerabilities could outweigh the incentive to share. 
5. Advances in cryptography and computational efficiency (e.g. quantum computing) could catchup in future. What you share now will be collected, stored and has the potential to be replayed and misused in future.
6. Your encryption keys are a single point of failure if all your messages are encrypted with it. Being able to extract the key for a single message will make it possible to decrypt every other messages -- including those shared up until that point and those to be shared in future. 

Assumption made here about the adversary are fairly practical i.e. he has access to computational resource and public content like encrypted messages, open source code and knowledge of vulnerabilities and technologies.

<img src="https://poorlydrawnlines.com/wp-content/uploads/2023/01/Interviewing_Bird.png" alt="drawing" width="500" height="400"/> 

Comparatively the end-to-end encrypted messaging applications we have been using sound much more reliable. Some might even be okay with non e2e messaging compared to the points above; at least our messages are not exposed for the whole world to see plus the ones who handle them have the incentive to keep them secure. So what can we learn from e2e messaging applications so that exchanging messages through blockchain is secure and reliable ?

## Why even try ?
Before rushing into an answer, lets ponder if we even require the ability to exchange secure message in blockchains. The term "secure message", here, is used as a generic term for a piece of information shared only between a trusted set of parties. It can be of the following forms.
- signals generated by an on-chain game about a players' secret moves that is shared only with a group
- textual or other multimedia messages 
- anonymous votes 
- response to surveys or interviews which need discretion, etc

In essence, secure exchange of message helps build systems which cling to the value of information asymmetry and human interaction. Because of this fundamental reason, we can not only expect there to be more than a handful of usecases, but we can also assume that some of these usecases can be things we may fail to realize at the outset. Now knowing how valuable secure messaging is and how conveniently web2 applications provide this service, wouldn't it just be easier to continue using web2 apps for it and use blockchains for a more web3-favored usecases altogether ? In fact, blockchain communities have been reliant upon web2 apps like Discord, Twitter and Telegram to disseminate public information, form groups to communicate in private, gather information for airdops and so on.

### "Decentralization" 
An obvious answer to the need for a product to be tied to blockchain is to go the route of decentralization-good-censorship-bad i.e. point out how web2 implementations are censor prone and how tying it to blockchain provides an alternate solution that can be relied upon. In this case, given how important the right to free speech is and how existing web2 based secure messaging services are either banned from certain places or are in close scrutiny, this claim about necessity of secure messaging through blockchain is not in itself an insufficient reason. But as we've learnt so far, it's possible for smart contracts to be black-listed, blockchain mining and token holding to be banned and some of the biggest "decentralized" chains to get paused. So the ball is likely on anyone's court right now when we talk about being a platform ideal for secure messaging.

### Integrated Products
Besides the standalone primary usecase mentioned above, secure messaging is useful as a plugin to more complex dapps. For example, it can be used in on-chain multiplayer games for private group chats or to securely log user interactions; it can be used with social dapps built on exclusivity where sharing content with only one's following could be desirable; it can be used with reward based dapps where only users with necessary credentials can decrypt the content and claim reward and so on.

TODO++++
- how XMTP and Farcaster have integrated their secure messaging to larger ecosystem
- etc

With this, we've learnt that the value of secure messaging is better understood if we consider it as a small integral dapp that fits in with other products and benefits the ecosystem.


## How Signal does it
Now, lets examine what we can learn from e2e messaging apps by considering Signal protocol. The protocol assumes a trustless server which stores encrypted user entries and relays encrypted messages between clients. 

### Asynchronous Exchage of Keys
Signal uses X3DH protocol to perform a two-way handshake between clients. The benefit of this approach compared to 3-way handshake commonly used by TLS is that both of the parties do not need to be online at the same time to establish shared key used for exchanging messages. 

### Refresh Encryption Keys Periodically
One of the main innovations of the protocol is the Double Ratchet Algorithm, which provides an efficient way to periodically update keys used to encrypt messages. Refreshing keys is meant to ensure that should some adversary gain access to the keys used now, he won't be able to use the same key to decrypt different set of messages encrypted with different set of keys. Such features are called Forward Secrecy and Post Compromise Security.

### Private Groups
Signal also specifies how its peer-to-peer messaging service can be extended to private group messages. 

### Modular Design
The algorithm has been battle tested for more than a decade and other e2e messaging apps also derive from it because of its reliability. It's modular enough to make upgrades to the cryptographic primitives it uses without breaking the protocol. Because of this flexibility, there have been studies to make the algorithm post quantum secure.


## How was this helpful ?


In conclusion, future decentralized applications are likely to require robust mechanisms of interaction between parties involved. The inherent nature of blockchain raises concerns around its reliability, which can be addressed by drawing practices from applications which we have already known to trust.